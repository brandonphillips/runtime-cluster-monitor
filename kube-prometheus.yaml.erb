alertmanager:
  config:
    <%= template 'alertmanager.yaml.erb', 4, '_alertmanager', binding %>
  templateFiles:
    alerts.tmpl: |
      <%= template 'alerts.tmpl.erb', 6, '_alerts', binding  %>
  alertmanagerSpec:
    routePrefix: /alertmanager/
    storage:
      volumeClaimTemplate:
        spec:
          accessModes: [ReadWriteOnce]
          resources:
            requests:
              storage: 2Gi

grafana:
  grafana.ini:
    server:
      root_url: '%(protocol)s://%(domain)s/grafana/'
      serve_from_sub_path: 'true'
    auth:
      disable_login_form: 'true'
      disable_signout_menu: 'true'
    auth.basic:
      enabled: 'false'
    auth.anonymous:
      enabled: 'true'
      org_role: Admin

kubeControllerManager:
  enabled: false

coreDns:
  enabled: false

kubeDns:
  enabled: true

kubeEtcd:
  enabled: false

kubeProxy:
  enabled: false

kubeScheduler:
  enabled: false

prometheusOperator:
  logLevel: error

prometheus:
  prometheusSpec:
    externalUrl: https://<%= ENV['cluster_name'] %>/prometheus/
    routePrefix: /prometheus/
    scrapeInterval: 10s
    additionalScrapeConfigs:
      <%= template 'scrape.yaml.erb', 6, '_scrape', binding %>
    storageSpec:
      volumeClaimTemplate:
        spec:
          accessModes: [ReadWriteOnce]
          resources:
            requests:
              storage: 70Gi

defaultRules:
  rules:
    time: false
    kubernetesApps: false
    kubernetesResources: false
    kubernetesSystem: false

additionalPrometheusRules:
  - name: cf-rules
    groups:
      <%= template 'alerts.yaml.erb', 6, '_rules', binding %>
